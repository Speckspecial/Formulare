\documentclass[a4paper, 10pt]{article}
\pdfminorversion=7

\usepackage[margin=1.5cm]{geometry}
\usepackage{graphicx}
\usepackage{titling}
\usepackage{setspace}
\usepackage{makecell}
\usepackage[unicode]{hyperref}
\usepackage{xcolor}
\usepackage[most]{tcolorbox}
\usepackage{ocgx2}      % erzeugt OCG-Layer in LaTeX
\usepackage{eforms}     
\usepackage{insdljs}    % eingebettetes JavaScript

\input{macros.tex}

\definecolor{svoblau}{RGB}{24,47,149}

\begin{insDLJS}[selectMemberType]{selectMemberType}{}
function selectMemberType(caller) 
{
    var radioMembership = this.getField("radioMitgliedschaft").value;
    var checkFamilyPartner = this.getField("checkPartner").value !== "Off";
    var numChilds = this.getField("txtKinder").value;
    if (! numChilds)
        numChilds = 0;
    if (numChilds > 5)
        numChilds = 5;

    var ocgs = this.getOCGs();
    if (!ocgs)
        return;

    var ocgAdultDepartment;
    var ocgChild;
    var ocgFamily;
    var ocgPartner;
    var ocgChilds = new Array(5);

    for (var i = 0; i < ocgs.length; i++) {
        if (ocgs[i].name == "AntragstellerAbteilung")
            ocgAdultDepartment = ocgs[i];
        else if (ocgs[i].name == "MeinKind")
            ocgChild = ocgs[i];
        else if (ocgs[i].name == "Familie")
            ocgFamily = ocgs[i];
        else if (ocgs[i].name == "Partner")
            ocgPartner = ocgs[i];
        else {
            for (var k = 0; k < 5; ++k)
            {
                var nameChild = "Kind" + k
                if (ocgs[i].name == nameChild)
                    ocgChilds[k] = ocgs[i];
            }
        }
    }

    function changeVisibilityMember(visible, postfix)
    {
        var displayVisible = visible ? display.visible : display.hidden;

        this.getField("txtVorname" + postfix).display = displayVisible;
        this.getField("txtNachname" + postfix).display = displayVisible;
        this.getField("txtGeburtsdatum" + postfix).display = displayVisible;
        this.getField("radioGeschlecht" + postfix).display = displayVisible;
        this.getField("radioAbteilung" + postfix).display = displayVisible;
    }

    function changeVisibilityAdult(visible) 
    {
        ocgAdultDepartment.state = visible;

        var displayVisible = visible ? display.visible : display.hidden;
        this.getField("radioAbteilungAntragsteller").display = displayVisible;
    }
    function changeVisibilityChild(visible) 
    {
        ocgChild.state = visible;
        changeVisibilityMember(visible, "Kind");
    }
    function changeVisibilityFamily(visible) 
    {
        ocgFamily.state = visible;
        ocgAdultDepartment.state = visible;

        var displayVisible = visible ? display.visible : display.hidden;
        this.getField("radioAbteilungAntragsteller").display = displayVisible;
        this.getField("checkPartner").display = displayVisible;
        this.getField("txtKinder").display = displayVisible;

        var checkBoxVisible = visible;
        if (! checkFamilyPartner)
            checkBoxVisible = false;
        ocgPartner.state = checkBoxVisible;
        changeVisibilityMember(checkBoxVisible, "Partner");

        for (var k = 0; k < numChilds; ++k) {
            ocgChilds[k].state = visible;
            changeVisibilityMember(visible, "Kind" + k);
        }
        for (var k = numChilds; k < 5; ++k) {
            ocgChilds[k].state = false;
            changeVisibilityMember(false, "Kind" + k);
        }
    }

    if (caller == "memberType")
    {
        radioMembership = event.value;
    }
    else if (caller == "checkPartner")
    {
        checkFamilyPartner = (event.value == "Yes");
    }
    else if (caller == "txtKinder")
    {
        numChilds = event.value;
    }
    console.println("radioMembership " + radioMembership);
    console.println("checkFamilyPartner " + checkFamilyPartner);
    console.println("numChilds " + numChilds);

    switch (radioMembership[12])
    {
        case "E":
            console.println("ADULT");
            changeVisibilityChild(false);
            changeVisibilityFamily(false);
            changeVisibilityAdult(true);
            break;
        case "K":
            console.println("CHILD");
            changeVisibilityAdult(false);
            changeVisibilityFamily(false);
            changeVisibilityChild(true);
            break;
        case "F":
            console.println("FAMILY");
            changeVisibilityAdult(false);
            changeVisibilityChild(false);
            changeVisibilityFamily(true);
            break;
    }
}
\end{insDLJS}

% ---------------------------------------------------------
% Dokument
% ---------------------------------------------------------
\pagenumbering{arabic}
\setlength{\parindent}{0pt}

\begin{document}

\begin{flushleft}
    \vspace*{-1.2cm}
    \begin{minipage}{0.8\textwidth}
        {\Huge\bfseries\textcolor{svoblau}{SV~1919~Osterburken~e.V.}}
        \\[1ex]{\Large AUFNAHMEANTRAG (Stand 02/2026) \hfill Seite \thepage}
        \\[4ex]
        Hiermit beantrage ich die Mitgliedschaft beim SV~1919~Osterburken~e.V..
    \end{minipage}
    \hfill
    \begin{minipage}{0.15\textwidth}
        \raggedleft
        \includegraphics[width=\linewidth]{SVO Logo 2019.jpg} % <-- Dein Logo hier
    \end{minipage}
\end{flushleft}

\begin{tcolorbox}[
    colback=white,    % Hintergrundfarbe
    colframe=svoblau,  % Rahmenfarbe
    title=Antragdaten,  % Der Titel
    fonttitle=\bfseries,     % Titel fett
    arc=1.5mm,           % Ecken (optional: arc=2mm für gerundet)
    boxrule=0.5mm            % Dicke des Rahmens
]
\begin{tabular}{@{}l l@{}}
\makecell[cl]{Eintrittsdatum:} & 
\makecell[cl]{\TextField[
    name=txtEintrittsdatum, 
    format={AFDate_FormatEx("dd.mm.yyyy");}, 
    keystroke={AFDate_KeystrokeEx("dd.mm.yyyy");}, 
    bordercolor={0 0 0},
    height=0.7cm
]{}}
\end{tabular}
\\[1ex]
\begin{tabular}{@{}l l@{}}
\ChoiceMenu[
    name=radioMitgliedschaft, 
    radio, radiosymbol=\ding{55}, 
    keystroke={selectMemberType("memberType");},
    bordercolor={0 0 0}
]{}{=E} & 
Mitgliedschaft für mich \\
\ChoiceMenu[
    name=radioMitgliedschaft,
    radio, radiosymbol=\ding{55},
    keystroke={selectMemberType("memberType");},
    bordercolor={0 0 0}
]{}{=K} & 
Mitgliedschaft für mein Kind (Antragsteller/-in ist erziehungsberechtigt.)\\
\ChoiceMenu[
    name=radioMitgliedschaft,
    radio, radiosymbol=\ding{55},
    keystroke={selectMemberType("memberType");},
    bordercolor={0 0 0}
]{}{=F} & 
Familienmitgliedschaft für mich, Partner/Partnerin und Kinder \\
\end{tabular}

\person{Antragsteller/-in}{Antragsteller}
\end{tcolorbox}

\begin{ocg}{AntragstellerAbteilung}{AntragstellerAbteilung}{true}
\begin{tcolorbox}[
    colback=white,    % Hintergrundfarbe
    colframe=svoblau,  % Rahmenfarbe
    title=Abteilung für Antragsteller/-in,  % Der Titel
    fonttitle=\bfseries,     % Titel fett
    arc=1.5mm,           % Ecken (optional: arc=2mm für gerundet)
    boxrule=0.5mm            % Dicke des Rahmens
]
\department{Antragsteller}
\end{tcolorbox}
\end{ocg}

\begin{ocg}{MeinKind}{MeinKind}{true}
\member{Mein Kind}{Kind}{Einzelmitgliedschaft für mein Kind}
\end{ocg}

\section*{Einverständniserklärung}

Ich erkenne die Vereinssatzung in allen Rechten und Pflichten an.
Ich bin damit einverstanden, Informationen, Einladungen etc. des Vereins per E-Mail zu erhalten.

\signature{Einverstaendnis}

\pagebreak
\headerfamily

\begin{ocg}{Familie}{Familie}{true}
\vspace{0.5cm}
\begin{tcolorbox}[
    colback=white,    % Hintergrundfarbe
    colframe=svoblau,  % Rahmenfarbe
    title=Mitgliedschaft für die gesante Familie,  % Der Titel
    fonttitle=\bfseries,     % Titel fett
    arc=1.5mm,           % Ecken (optional: arc=2mm für gerundet)
    boxrule=0.5mm            % Dicke des Rahmens
]
Familienmitgliedschaft mit 
\CheckBox[
    name=checkPartner,
    bordercolor={0 0 0}, 
    keystroke={selectMemberType("checkPartner");}
]{}
Partner/-in und~\TextField[
    name=txtKinder,
    keystroke={selectMemberType("txtKinder");},
    bordercolor={0 0 0},
    height=0.7cm,
    width=0.8cm
]{} Kind/Kinder:
\end{tcolorbox}
\end{ocg}

\begin{ocg}{Partner}{Partner}{true}
\member{Partner/-in}{Partner}{Mitgliedschaft für die gesante Familie}
\end{ocg}

\begin{ocg}{Kind0}{Kind0}{true}
\member{1. Kind}{Kind0}{Mitgliedschaft für die gesante Familie}
\end{ocg}

\begin{ocg}{Kind1}{Kind1}{true}
\member{2. Kind}{Kind1}{Mitgliedschaft für die gesante Familie}
\end{ocg}

\pagebreak
\headerfamily

\begin{ocg}{Kind2}{Kind2}{true}
\member{3. Kind}{Kind2}{Mitgliedschaft für die gesante Familie}
\end{ocg}

\begin{ocg}{Kind3}{Kind3}{true}
\member{4. Kind}{Kind3}{Mitgliedschaft für die gesante Familie}
\end{ocg}

\begin{ocg}{Kind4}{Kind4}{true}
\member{5. Kind}{Kind4}{Mitgliedschaft für die gesante Familie}
\end{ocg}

\pagebreak

\begin{flushleft}
    \vspace*{-1.2cm}
    \begin{minipage}{0.8\textwidth}
        {\Huge\bfseries\textcolor{svoblau}{SV~1919~Osterburken~e.V.}}
        \\[1ex]{\Large AUFNAHMEANTRAG (Stand 02/2026) \hfill Seite \thepage}
        \\[4ex]
        {\huge\bfseries SEPA Lastschriftmandat}
    \end{minipage}
    \hfill
    \begin{minipage}{0.15\textwidth}
        \raggedleft
        \includegraphics[width=\linewidth]{SVO Logo 2019.jpg} % <-- Dein Logo hier
    \end{minipage}
\end{flushleft}



\end{document}
